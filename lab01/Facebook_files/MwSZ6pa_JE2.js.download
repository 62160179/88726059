if (self.CavalryLogger) { CavalryLogger.start_js(["jIw6F"]); }

__d("LSMailboxInitialSyncRequest.bs",["requireCond","cr:1790891"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1790891").send;f.$LSGraphqlMailboxInitialSyncRequest$OR$LSHTTPMailboxInitialSyncRequest$requireCond=b("cr:1790891");f.send=a}),null);
__d("LSSuspense.bs",["Promise"],(function(a,b,c,d,e,f){"use strict";var g=function(a){throw a};function a(a){return{contents:0}}function c(a){a.contents=0}function d(a,c){var d=a.contents;if(typeof d!=="number")if(d.TAG)return d._0;else return g(d._0);d=c.then(function(c){a.contents={TAG:1,_0:c};return b("Promise").resolve(void 0)});a.contents={TAG:0,_0:d};return g(d)}f.$$throw=g;f.make=a;f.reset=c;f.getOrSuspend=d}),null);
__d("LSVersion.bs",["gkx","LSVersion","LSSecureVersion","MessengerWebSyncScripts"],(function(a,b,c,d,e,f){"use strict";a=b("gkx")("1671170")?b("LSSecureVersion"):b("LSVersion");c=b("MessengerWebSyncScripts").schemaVersionV2;d=c==null?a:c;f.version=d}),null);
__d("MessengerWebQuickLogModule",[],(function(a,b,c,d,e,f){a=Object.freeze({COMPOSER_INTERACTION:25296900,FETCH_MORE_THREAD_LIST:25296906,FETCH_THREAD_INFO:25296904,FETCH_THREAD_LIST:25296905,FIRSTCHATTABOPEN_WWW:25296897,GROUP_INPUT_INDIVIDUAL_TAB_OPEN_WWW:25296899,GROUP_INPUT_TAB_OPEN_WWW:25296898,LS_INIT:25305590,PAGE_LOAD_MDOTCOM_WWW:25296901,SEND_MESSAGE:25296903,THREAD_LOAD_MDOTCOM_WWW:25296902});e.exports=a}),null);
__d("MqttState.bs",[],(function(a,b,c,d,e,f){"use strict";a="Connected";b="Disconnected";c="Connecting";f.connected=a;f.disconnected=b;f.connecting=c}),null);
__d("LSBootstrap.bs",["Promise","bs_curry","gkx","LSVersion.bs","MqttState.bs","LSSuspense.bs","requireCond","FBMqttChannel","ChannelClientID","requireDeferred","ExecutionEnvironment","recoverableViolation","QuickPerformanceLogger","MessengerWebQuickLogModule","LSMailboxInitialSyncRequest.bs","cr:1811945"],(function(a,b,c,d,e,f){"use strict";function g(a){if(b("gkx")("1671170"))return a.MQTT.publish;else return a.HTTP.publish}var h=b("requireDeferred")("LSWebReq.bs");function i(){b("FBMqttChannel").registerExtraConnectPayloadProvider({getPublishMessages:function(a){b("QuickPerformanceLogger").markerPoint(b("MessengerWebQuickLogModule").LS_INIT,"create_connect_payload");return[{topic:"/ls_app_settings",payload:JSON.stringify({ls_sv:b("LSVersion.bs").version,ls_fdid:""}),qos:1}]}})}var j=b("LSSuspense.bs").make(void 0);function k(a){b("QuickPerformanceLogger").markerPoint(b("MessengerWebQuickLogModule").LS_INIT,"send_initial_sync");return b("Promise").all([b("bs_curry")._1(b("LSMailboxInitialSyncRequest.bs").send,a).then(function(a){b("QuickPerformanceLogger").markerPoint(b("MessengerWebQuickLogModule").LS_INIT,"initial_sync_received");return b("Promise").resolve(a)}),h.load().then(function(a){b("QuickPerformanceLogger").markerPoint(b("MessengerWebQuickLogModule").LS_INIT,"LSWebReq_loaded");return b("Promise").resolve(a)})]).then(function(a){return b("bs_curry")._1(a[1].HTTP.handleResponse,a[0])})["catch"](function(a){b("QuickPerformanceLogger").markerPoint(b("MessengerWebQuickLogModule").LS_INIT,"end");b("QuickPerformanceLogger").markerEnd(b("MessengerWebQuickLogModule").LS_INIT,"failure_during_init_sync");b("recoverableViolation")("Init sync failed","messenger_web_product",a);j.contents={TAG:1,_0:void 0};return b("Promise").resolve(void 0)}).then(function(a){j.contents={TAG:1,_0:void 0};b("QuickPerformanceLogger").markerPoint(b("MessengerWebQuickLogModule").LS_INIT,"end");b("QuickPerformanceLogger").markerEnd(b("MessengerWebQuickLogModule").LS_INIT,"success_with_init_sync");return b("Promise").resolve(void 0)}).then(function(a){h.onReady(function(a){var c=g(a);b("bs_curry")._1(a.Tasks.watchPendingTasks,a.MQTT.publish);b("bs_curry")._2(a.Sync.watchSyncGroups,c,a.MQTT.publish);return b("bs_curry")._2(a.Sync.startOrResume,c,a.MQTT.publish)});return b("Promise").resolve(void 0)})}function l(){b("FBMqttChannel").subscribe("/ls_resp",function(a){h.onReady(function(c){return b("bs_curry")._2(c.MQTT.handleResponse,g(c),a)})})}function m(){b("FBMqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(a){if(a===b("MqttState.bs").connected){h.onReady(function(a){return b("bs_curry")._1(a.MQTT.handleReconnect,g(a))});return}}})}var n={contents:!1},o=!b("gkx")("1671170");function a(a){var c=j.contents;if(typeof c!=="number")if(c.TAG)return c._0;else return b("LSSuspense.bs").$$throw(c._0);c=b("ExecutionEnvironment").canUseDOM?k(a):b("Promise").resolve(void 0);j.contents={TAG:0,_0:c};return b("LSSuspense.bs").$$throw(c)}function c(a){if(!(!n.contents&&b("ExecutionEnvironment").canUseDOM))return;n.contents=!0;b("QuickPerformanceLogger").markerStartFromNavStart(b("MessengerWebQuickLogModule").LS_INIT);b("QuickPerformanceLogger").markerPoint(b("MessengerWebQuickLogModule").LS_INIT,"start");i();l();m();if(o){var c=j.contents;typeof c==="number"&&(j.contents={TAG:0,_0:k(a)})}else b("QuickPerformanceLogger").markerPoint(b("MessengerWebQuickLogModule").LS_INIT,"end"),b("QuickPerformanceLogger").markerEnd(b("MessengerWebQuickLogModule").LS_INIT,"success_without_init_sync"),h.onReady(function(a){var c=g(a);b("bs_curry")._1(a.Tasks.watchPendingTasks,a.MQTT.publish);b("bs_curry")._2(a.Sync.watchSyncGroups,c,a.MQTT.publish);return b("bs_curry")._1(a.MQTT.handleReconnect,c)});if(!(b("cr:1811945")==null))return b("bs_curry")._1(b("cr:1811945").writeCookie,{device_id:b("ChannelClientID").getID(),schema_version:b("LSVersion.bs").version})}d=h;e=b("cr:1811945");f.getPublishHttp=g;f.$LSWebReq$Deferred=h;f.lsWebReqDeferred=d;f.useIsInitialised=a;f.$LSCookie$OR$null$requireCond=b("cr:1811945");f.lsCookie=e;f.start=c}),null);
__d("LSBootstrap.re",["LSBootstrap.bs"],(function(a,b,c,d,e,f){a=function(a){a=b("LSBootstrap.bs").start(a.numThreads);return a};f.start=a}),null);
__d("LSChatBootstrapParams.bs",["gkx"],(function(a,b,c,d,e,f){"use strict";a=b("gkx")("1805180")?0:15;c="chat_tabs";f.numThreads=a;f.callerSource=c}),null);
__d("LSChatBootstrapParams.re",["LSChatBootstrapParams.bs"],(function(a,b,c,d,e,f){a=b("LSChatBootstrapParams.bs").numThreads;f.numThreads=a;c=b("LSChatBootstrapParams.bs").callerSource;f.callerSource=c}),null);
__d("MWLSChatProvider.react",["LSBootstrap.re","LSChatBootstrapParams.re","MWChatMultiTabProvider.react","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");b("LSBootstrap.re").start({numThreads:b("LSChatBootstrapParams.re").numThreads});function a(a){a=a.children;return g.jsx(b("MWChatMultiTabProvider.react"),{children:a})}}),null);
__d("LSSyncChannel.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=b("bs_caml_int64").mk(2,0);d=b("bs_caml_int64").mk(3,0);f.realtime=a;f.http=c;f.dgw=d}),null);
__d("LSMailboxInitialSyncCursor.bs",["CurrentLocale","LSSyncChannel.bs"],(function(a,b,c,d,e,f){"use strict";a=b("CurrentLocale").get();c={scale:1,preview_height:200,preview_width:150,full_height:200,snapshot_num_threads_per_page:15,locale:a};d={contents:b("LSSyncChannel.bs").realtime};e={contents:0};a={contents:c};f.defaultSyncParams=c;f.syncChannel=d;f.lastSyncTimestampMs=e;f.syncParams=a}),null);
__d("LSRequestType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";c=(a=b("bs_caml_int64")).one;d=a.mk(2,0);e=a.mk(3,0);b=a.mk(4,0);f.initSync=c;f.resumeSync=d;f.taskBatch=e;f.fireForget=b}),null);
__d("XLightSpeedWebRequestController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/lightspeedweb/request/",{device_id:{type:"String",required:!0},request_id:{type:"Int",required:!0},request_type:{type:"Int"},request_payload:{type:"String"}})}),null);
__d("LSHTTPMailboxInitialSyncRequest.bs",["bs_js_dict","LSVersion.bs","bs_caml_int64","LSRequestType.bs","ChannelClientID","cometAsyncFetch","bs_js_null_undefined","MessengerWebRegion","LSMailboxInitialSyncCursor.bs","LightspeedWebMailboxEpochId","XLightSpeedWebRequestController"],(function(a,b,c,d,e,f){"use strict";function a(a){b("LSMailboxInitialSyncCursor.bs").lastSyncTimestampMs.contents=Date.now();var c=b("LSMailboxInitialSyncCursor.bs").syncParams.contents;a=b("bs_js_null_undefined").fromOption(JSON.stringify({database:1,version:b("LSVersion.bs").version,epoch_id:b("LightspeedWebMailboxEpochId").epochId,last_applied_cursor:null,failure_count:null,sync_params:b("bs_js_null_undefined").fromOption(JSON.stringify({scale:c.scale,preview_height:c.preview_height,preview_width:c.preview_width,full_height:c.full_height,snapshot_num_threads_per_page:a,locale:c.locale}))}));return b("cometAsyncFetch")(b("XLightSpeedWebRequestController").getURIBuilder().setString("device_id",b("ChannelClientID").getID()).setInt("request_id",0).setInt("request_type",b("bs_caml_int64").to_int32(b("LSRequestType.bs").initSync)).setString("request_payload",a).getURI().toString(),{method:"POST",requestHeaders:b("bs_js_dict").fromArray([["X-MSGR-Region",b("MessengerWebRegion").region]]),data:{}})}f.send=a}),null);