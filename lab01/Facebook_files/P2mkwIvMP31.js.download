if (self.CavalryLogger) { CavalryLogger.start_js(["z3WTn"]); }

__d("FBLikeSvgIcon.bs",["React","bs_caml_option"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a){var c=a.className;a=a.color;var d={d:"M16,9.1c0-0.8-0.3-1.1-0.6-1.3c0.2-0.3,0.3-0.7,0.3-1.2c0-1-0.8-1.7-2.1-1.7h-3.1c0.1-0.5,0.2-1.3,0.2-1.8 c0-1.1-0.3-2.4-1.2-3C9.3,0.1,9,0,8.7,0C8.1,0,7.7,0.2,7.6,0.4C7.5,0.5,7.5,0.6,7.5,0.7L7.6,3c0,0.2,0,0.4-0.1,0.5L5.7,6.6 c0,0-0.1,0.1-0.1,0.1l0,0l0,0L5.3,6.8C5.1,7,5,7.2,5,7.4v6.1c0,0.2,0.1,0.4,0.2,0.5c0.1,0.1,1,1,2,1h5.2c0.9,0,1.4-0.3,1.8-0.9 c0.3-0.5,0.2-1,0.1-1.4c0.5-0.2,0.9-0.5,1.1-1.2c0.1-0.4,0-0.8-0.2-1C15.6,10.3,16,9.9,16,9.1z"};a!==void 0&&(d.fill=b("bs_caml_option").valFromOption(a));var e={d:"M3.3,6H0.7C0.3,6,0,6.3,0,6.7v8.5C0,15.7,0.3,16,0.7,16h2.5C3.7,16,4,15.7,4,15.3V6.7C4,6.3,3.7,6,3.3,6z"};a!==void 0&&(e.fill=b("bs_caml_option").valFromOption(a));a={children:[g.jsx("path",d),g.jsx("path",e)],height:"20",width:"20",viewBox:"0 0 16 16"};c!==void 0&&(a.className=b("bs_caml_option").valFromOption(c));return g.jsxs("svg",a)}c=a;f.make=c}),null);
__d("MWLikeSvgIcon.bs",["requireCond","cr:1828791"],(function(a,b,c,d,e,f){"use strict";a=b("cr:1828791").make;f.$MDSLikeSvgIcon$OR$FBLikeSvgIcon$requireCond=b("cr:1828791");f.make=a}),null);
__d("Base64.bs",["base64-js"],(function(a,b,c,d,e,f){"use strict";function g(a){return b("base64-js").fromByteArray(new TextEncoder().encode(a))}function a(a){var c=new TextDecoder();return c.decode(b("base64-js").toByteArray(a))}function c(a){var b=new TextDecoder();a=new Uint8Array(a);return g(b.decode(a))}function d(a){return b("base64-js").fromByteArray(new Uint8Array(a))}function e(a){return b("base64-js").toByteArray(a).buffer}f.encodeUnicode=g;f.decodeUnicode=a;f.encodeArrayBuffer=c;f.fromArrayBuffer=d;f.toArrayBuffer=e}),null);
__d("MWThreadPreview.bs",["LS.bs","FBID.bs","bs_curry","bs_int64","LSVec.bs","React","LSInt64.bs","MWLSActor.bs","SkytaleDB","stylex","bs_caml_format","bs_caml_option","MWThreadKey.bs","promiseDone","MWChatTabNew.bs","LSTransaction.bs","SkytaleDBExec.bs","SkytaleDBHook.bs","SkytaleDBQuery.bs","MWUIChatTabState.bs","MWThread_DEPRECATED.bs","LSMessagingThreadTypeUtil.bs","MWChatConnectionStatusCard.bs","SkytaleDBQuerySubscriptionHook.bs","CometProgressRingIndeterminate.react","LSMailboxVerifyThreadRowExistsStoredProcedure","LSMailboxLocalCreateOptimisticGroupThreadStoredProcedure"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React");(g||(g=b("stylex"))).inject(".alzwoclg{display:flex}",1);g.inject(".i85zmo3j{align-items:center}",1);g.inject(".jcxyg2ei{justify-content:center}",1);g.inject(".cgu29s5g{flex-grow:1}",1);g.inject(".alzwoclg{display:flex}",1);g.inject(".jg3vgc78{flex-basis:0}",1);g.inject(".cqf1kptm{flex-direction:column}",1);g.inject(".cgu29s5g{flex-grow:1}",1);g.inject(".k1z55t6l{font-size:0.9375rem}",1);g.inject(".g4tp4svg{z-index:0}",1);var i={spinner:{display:"alzwoclg",alignItems:"i85zmo3j",justifyContent:"jcxyg2ei",flexGrow:"cgu29s5g"},threadPreviewContainer:{display:"alzwoclg",flexBasis:"jg3vgc78",flexDirection:"cqf1kptm",flexGrow:"cgu29s5g",fontSize:"k1z55t6l",zIndex:"g4tp4svg"}},j=h.createContext({hasContent:{contents:!1},isTabFocused:!1,onBeforeOpenTabForGroup:function(a){},openTabForUser:function(a){},openTabForGroup:function(a){},openTabForPage:function(a){},submitted:!1});function k(a){var c=a.children,d=a.hasContent,e=a.isTabFocused,f=a.onBeforeOpenTabForGroup,g=a.openTabForUser,i=a.openTabForGroup;a=a.openTabForPage;var k=h.useState(function(){return!1}),l=k[1],m=h.useCallback(function(a){b("bs_curry")._1(l,function(a){return!0});return b("bs_curry")._1(f,void 0)},[l,f]);k=k[0];d={hasContent:d,isTabFocused:e,onBeforeOpenTabForGroup:m,openTabForUser:g,openTabForGroup:i,openTabForPage:a,submitted:k};return h.createElement(j.Provider,{value:d,children:c})}c={make:k};function l(a){var c=a.thread;a=c.a;var d=c.O,e=d!==void 0?b("LSInt64.bs").string(d)===b("LSInt64.bs").string(a):!1;d=b("LSMessagingThreadTypeUtil.bs").isGroup(a)||e?{NAME:"Group",VAL:b("FBID.bs").ofStringExn(b("bs_int64").to_string(a))}:{NAME:"User",VAL:b("FBID.bs").ofStringExn(b("bs_int64").to_string(a))};var f=h.useContext(j),k=f.submitted,l=f.openTabForGroup,m=f.onBeforeOpenTabForGroup,n=h.useCallback(function(a){b("bs_curry")._1(m,void 0);if(!e)return b("bs_curry")._1(l,a)},[l,e,m]);h.useEffect(function(){var a=c.O;a!==void 0&&k&&b("bs_int64").to_string(a)!==b("bs_int64").to_string(c.a)&&b("bs_curry")._1(l,b("FBID.bs").ofStringExn(b("bs_int64").to_string(c.a)))},[c,l,k]);return h.jsx("div",{children:h.jsx(b("MWThread_DEPRECATED.bs").make,{id:d,children:h.jsx(b("MWThreadKey.bs").make,{id:a,children:h.jsx(b("MWUIChatTabState.bs").Provider.make,{tab:{_0:d},children:h.jsx(b("MWChatTabNew.bs").ExistingThreadPreview.make,{isTabFocused:f.isTabFocused,hasContent:f.hasContent,openTabForGroup:n,openTabForUser:f.openTabForUser,openTabForPage:f.openTabForPage,isOptimisticThread:e})})})}),className:(g||(g=b("stylex")))(i.threadPreviewContainer)})}d={make:l};function m(a){var c=a.threadKey,d=a.threadType,e=b("SkytaleDBHook.bs").useHook(void 0);h.useEffect(function(){b("promiseDone")(b("LSTransaction.bs").run(e,function(a){return b("LSMailboxVerifyThreadRowExistsStoredProcedure")(b("bs_caml_format").caml_int64_of_string(c),d,b("bs_curry")._1(b("LS.bs").make,a))},"readWrite"),void 0,void 0)},[e,c,d]);a=b("SkytaleDBQuerySubscriptionHook.bs").useFirst(h.useMemo(function(){return b("SkytaleDBQuery.bs").getKeyRange(b("SkytaleDB").table(e,"threads").asc,{hd:b("bs_caml_format").caml_int64_of_string(c),tl:0})},[e,c]));if(a!==void 0)return h.jsx(l,{thread:a});else return h.jsx("div",{children:h.jsx(b("CometProgressRingIndeterminate.react"),{color:"disabled",size:24}),className:(g||(g=b("stylex")))(i.spinner)})}e={make:m};function n(a){var c=a.tokens,d=a.participants,e=b("SkytaleDBHook.bs").useHook(void 0),f=b("bs_int64").to_string(b("MWLSActor.bs").useActor(void 0)),j=b("SkytaleDBQuerySubscriptionHook.bs").useArray(h.useMemo(function(){return b("SkytaleDBQuery.bs").map(b("SkytaleDBQuery.bs").filter(b("SkytaleDB").table(e,"participants").asc,function(a){return d.has(b("bs_int64").to_string(a.b))}),function(a){return b("bs_int64").to_string(a.a)})},[e,d])),k=b("SkytaleDBQuerySubscriptionHook.bs").useFirst(h.useMemo(function(){var a=new Set(j);return b("SkytaleDBQuery.bs").filter(b("SkytaleDBQuery.bs").filter(b("SkytaleDBQuery.bs").filter(b("SkytaleDB").table(e,"threads").asc,function(a){return a.d===void 0}),function(c){c=c.O;if(c!==void 0)return a.has(b("bs_int64").to_string(c));else return!1}),function(a){a=a.O;if(a===void 0)return!1;var c=new Set(b("SkytaleDBExec.bs").toArray(b("SkytaleDBQuery.bs").filter(b("SkytaleDBQuery.bs").map(b("SkytaleDBQuery.bs").getKeyRange(b("SkytaleDB").table(e,"participants").index("threadKeyReadWatermarkTimestampMs").desc,{hd:a,tl:0}),function(a){return b("bs_int64").to_string(a.b)}),function(a){return a!==f}))),g=new Set();d.forEach(function(a){if(c.has(a)){g.add(a);return}});return g.size===d.size})},[e,j,d,f]));h.useEffect(function(){k!==void 0||b("LSTransaction.bs").run(e,function(a){return b("LSMailboxLocalCreateOptimisticGroupThreadStoredProcedure")(b("LSVec.bs").make(c.map(function(a){return b("bs_caml_format").caml_int64_of_string(a.b)})),void 0,b("bs_curry")._1(b("LS.bs").make,a))},"readWrite")},[e,c,k]);if(k!==void 0)return h.jsx(l,{thread:k});else return h.jsx("div",{children:h.jsx(b("CometProgressRingIndeterminate.react"),{color:"disabled",size:24}),className:(g||(g=b("stylex")))(i.spinner)})}var o={make:n};function p(a){var c=a.tokens,d=b("SkytaleDBHook.bs").useHook(void 0),e=b("bs_int64").to_string(b("MWLSActor.bs").useActor(void 0)),f=h.useMemo(function(){return new Set(c.map(function(a){return a.b}))},[c]),g=b("SkytaleDBQuerySubscriptionHook.bs").useArray(h.useMemo(function(){return b("SkytaleDBQuery.bs").map(b("SkytaleDBQuery.bs").filter(b("SkytaleDB").table(d,"participants").asc,function(a){return f.has(b("bs_int64").to_string(a.b))}),function(a){return b("bs_int64").to_string(a.a)})},[d,f]));a=b("SkytaleDBQuerySubscriptionHook.bs").useFirst(h.useMemo(function(){var a=new Set(g);return b("SkytaleDBQuery.bs").filter(b("SkytaleDBQuery.bs").filter(b("SkytaleDBQuery.bs").filter(b("SkytaleDB").table(d,"threads").asc,function(a){return a.d===void 0}),function(c){return a.has(b("bs_int64").to_string(c.a))}),function(a){a=b("SkytaleDBExec.bs").toArray(b("SkytaleDBQuery.bs").filter(b("SkytaleDBQuery.bs").map(b("SkytaleDBQuery.bs").getKeyRange(b("SkytaleDB").table(d,"participants").index("threadKeyReadWatermarkTimestampMs").desc,{hd:a.a,tl:0}),function(a){return b("bs_int64").to_string(a.b)}),function(a){return a!==e}));if(a.length!==f.size)return!1;else return a.every(function(a){return f.has(a)})})},[d,g,f,e]));if(a!==void 0)return h.jsx(l,{thread:a});else return h.jsx(n,{tokens:c,participants:f})}var q={make:p};function a(a){var c=a.tokens,d=a.hasContent,e=a.isTabFocused,f=a.onBeforeOpenTabForGroup,g=a.openTabForUser,i=a.openTabForGroup,j=a.openTabForPage;a=a.empty;d=d!==void 0?d:{contents:!0};e=e!==void 0?e:!0;f=f!==void 0?f:function(a){};a=a!==void 0?b("bs_caml_option").valFromOption(a):null;var l=b("bs_int64").to_string(b("MWLSActor.bs").useActor(void 0)),n=h.useMemo(function(){var a=[];c.forEach(function(b){b=b.getServerSearchResult();if(b!==void 0){a.push(b);return}});return a},[c]),o,q=0,r=n.length;if(r>=3)q=1;else switch(r){case 0:o=a;break;case 1:r=n[0];o=h.jsx(m,{threadKey:r.b,threadType:r.e});break;case 2:a=n[0];r=n[1];a.b===l?o=h.jsx(m,{threadKey:r.b,threadType:r.e}):r.b===l?o=h.jsx(m,{threadKey:a.b,threadType:a.e}):q=1;break}q===1&&(o=h.jsx(p,{tokens:n.filter(function(a){return a.b!==l})}));return h.jsxs(k,{children:[h.jsx(b("MWChatConnectionStatusCard.bs").make,{}),o],hasContent:d,isTabFocused:e,onBeforeOpenTabForGroup:f,openTabForUser:g,openTabForGroup:i,openTabForPage:j})}a=a;f.styles=i;f.context=j;f.MWThreadPreviewContextProvider=c;f.ThreadPreview=d;f.OneOnOnePreview=e;f.GroupPreviewOptimistic=o;f.GroupPreview=q;f.make=a}),null);
__d("NavigateToThreadHook.bs",["bs_curry","React","MWInboxRouteBuilder.bs","useCometRouterDispatcher"],(function(a,b,c,d,e,f){"use strict";var g=b("React");function a(a){var c=b("useCometRouterDispatcher")();return g.useCallback(function(d){if(c==null)return;b("bs_curry")._1(a,void 0);d=b("bs_curry")._1(b("MWInboxRouteBuilder.bs").buildURL,{thread_key:d});return c.go(d)},[c,a])}f.useHook=a}),null);
__d("MWLSInboxNewMessageInner.bs",["bs_curry","React","stylex","LSDatabaseType.bs","MWThreadPreview.bs","MWLSDatabaseLazySync.bs","NavigateToThreadHook.bs","CometPlaceholder.react","MWThreadListNewMessageHook.bs","MWChatSearchTypeahead.react","MWThreadListNewMessageState.bs","MWInboxTokenizerTokenStrategy.react","CometProgressRingIndeterminate.react","useMWLightSpeedChatSearchSuggestedContacts","MWChatTokenizerLayoutContextualStrategy.react"],(function(a,b,c,d,e,f){"use strict";var g,h=b("React");(g||(g=b("stylex"))).inject(".jg3vgc78{flex-basis:0}",1);g.inject(".cgu29s5g{flex-grow:1}",1);g.inject(".lq84ybu9{overflow-x:hidden}",1);g.inject(".hf30pyar{overflow-y:hidden}",1);g.inject(".cqf1kptm{flex-direction:column}",1);g.inject(".alzwoclg{display:flex}",1);g.inject(".lg77cbj3{background-color:var(--messenger-card-background)}",1);g.inject(".q46jt4gp{padding-top:8px}",1);g.inject(".alzwoclg{display:flex}",1);g.inject(".i85zmo3j{align-items:center}",1);g.inject(".jcxyg2ei{justify-content:center}",1);g.inject(".cgu29s5g{flex-grow:1}",1);g.inject(".mfycix9x{border-bottom:1px solid var(--divider)}",.3);g.inject(".rcrnfkcx{box-shadow:none}",1);g.inject(".jez8cy9q{flex-shrink:0}",1);g.inject(".dnr7xe2t{min-height:0}",1);g.inject(".b0ur3jhr{z-index:1}",1);g.inject(".lg77cbj3{background-color:var(--messenger-card-background)}",1);g.inject(".fyn85a33{max-height:100%}",1);g.inject(".gtwc5u54{--T68779821:0 2px 9px 0 var(--shadow-1);-webkit-box-shadow:var(--T68779821);box-shadow:0 2px 9px 0 var(--shadow-1)}",1);var i={root:{flexBasis:"jg3vgc78",flexGrow:"cgu29s5g",overflowX:"lq84ybu9",overflowY:"hf30pyar",flexDirection:"cqf1kptm",display:"alzwoclg",backgroundColor:"lg77cbj3",paddingTop:"q46jt4gp"},spinner:{display:"alzwoclg",alignItems:"i85zmo3j",justifyContent:"jcxyg2ei",flexGrow:"cgu29s5g"},searchInputForContactsList:{borderBottom:"mfycix9x",boxShadow:"rcrnfkcx"},searchInput:{flexShrink:"jez8cy9q",minHeight:"dnr7xe2t",zIndex:"b0ur3jhr",backgroundColor:"lg77cbj3",maxHeight:"fyn85a33",boxShadow:"gtwc5u54"}};g.inject(".h8391g91{border-top-left-radius:8px}",1,".h8391g91{border-top-right-radius:8px}");g.inject(".m0cukt09{border-top-right-radius:8px}",1,".m0cukt09{border-top-left-radius:8px}");g.inject(".kpwa50dg{border-bottom-right-radius:8px}",1,".kpwa50dg{border-bottom-left-radius:8px}");g.inject(".ta68dy8c{border-bottom-left-radius:8px}",1,".ta68dy8c{border-bottom-right-radius:8px}");g.inject(".qdjxsfl2{--T68779821:0 12px 28px 0 var(--shadow-2),0 2px 4px 0 var(--shadow-1),inset 0 0 0 1px var(--shadow-inset);-webkit-box-shadow:var(--T68779821);box-shadow:0 12px 28px 0 var(--shadow-2),0 2px 4px 0 var(--shadow-1),inset 0 0 0 1px var(--shadow-inset)}",1,".qdjxsfl2{--T68779821:0 12px 28px 0 var(--shadow-2), 0 2px 4px 0 var(--shadow-1), inset 0 0 0 1px var(--shadow-inset);-webkit-box-shadow:var(--T68779821);box-shadow:0 12px 28px 0 var(--shadow-2), 0 2px 4px 0 var(--shadow-1), inset 0 0 0 1px var(--shadow-inset)}");g.inject(".q46jt4gp{padding-top:8px}",1);g.inject(".r5g9zsuq{padding-bottom:8px}",1);var j={viewXStyle:{borderTopStartRadius:"h8391g91",borderTopEndRadius:"m0cukt09",borderBottomEndRadius:"kpwa50dg",borderBottomStartRadius:"ta68dy8c",boxShadow:"qdjxsfl2",paddingTop:"q46jt4gp",paddingBottom:"r5g9zsuq"}};function a(a){var c=b("MWLSDatabaseLazySync.bs").useSync(b("LSDatabaseType.bs").ranking),d=h.useContext(b("MWThreadListNewMessageState.bs").context);a=h.useState(function(){return d.entries});var e=a[1];a=a[0];var f=h.useState(function(){return!1}),k=f[1],l=h.useCallback(function(a){return b("bs_curry")._1(e,function(b){return a})},[e]),m=b("MWThreadListNewMessageState.bs").useDispatch(void 0),n=h.useCallback(function(a){return b("bs_curry")._1(m,0)},[m]),o=b("NavigateToThreadHook.bs").useHook(n);n=h.useCallback(function(a){var c=a.getResultType();switch(c){case"group":case"page":return b("bs_curry")._1(o,a.getRawData().id);default:return}},[o]);var p=h.useCallback(function(a){return b("bs_curry")._1(k,function(a){return!0})},[k]),q=h.useCallback(function(a){b("bs_curry")._1(k,function(a){return!0});return b("bs_curry")._1(o,a)},[k,o]);h.useEffect(function(){b("bs_curry")._1(c,void 0)},[c]);b("MWThreadListNewMessageHook.bs").useHook(a);var r=h.useMemo(function(){return b("MWChatTokenizerLayoutContextualStrategy.react").createMWChatTokenizerLayoutContextualStrategy(!0)},[]),s=b("useMWLightSpeedChatSearchSuggestedContacts")();return h.jsxs("div",{children:[h.jsx("div",{children:h.jsx(b("MWChatSearchTypeahead.react"),{emptyEntries_DO_NOT_USE:s,isDisabled:f[0],onAddToken:n,onChangeTokens:l,onSearchAbandon:function(a){},onSearchCompletion:function(a){},tokens:a,xstyles:j,tokenItemRenderer:b("MWInboxTokenizerTokenStrategy.react"),layoutStategyRenderer:r}),className:(g||(g=b("stylex")))(i.searchInput,a.length===0?i.searchInputForContactsList:!1)}),h.jsx(b("CometPlaceholder.react"),{children:h.jsx(b("MWThreadPreview.bs").make,{tokens:a,onBeforeOpenTabForGroup:p,openTabForUser:q,openTabForGroup:q,openTabForPage:function(a){}}),fallback:h.jsx("div",{children:h.jsx(b("CometProgressRingIndeterminate.react"),{color:"disabled",size:24}),className:g(i.spinner)})})],className:g(i.root)})}c=a;f.styles=i;f.xstyles=j;f.make=c}),null);